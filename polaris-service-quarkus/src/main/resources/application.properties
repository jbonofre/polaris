#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#   http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#

quarkus.application.name=Polaris
quarkus.banner.path=polaris-banner.txt

quarkus.config.mapping.validate-unknown=true

quarkus.http.auth.basic=false
quarkus.http.access-log.enabled=true
quarkus.http.enable-compression=true
quarkus.http.enable-decompression=true
quarkus.http.body.handle-file-uploads=false
quarkus.http.limits.max-body-size=10240K
quarkus.http.compress-media-types=application/json,text/html,text/plain

quarkus.http.cors.origins=http://localhost:8080
quarkus.http.cors.methods=PATCH, POST, DELETE, GET, PUT
quarkus.http.cors.headers=*
quarkus.http.cors.exposed-headers=*
quarkus.http.cors.access-control-max-age=PT10M
quarkus.http.cors.access-control-allow-credentials=true

quarkus.http.port=8181
quarkus.http.test-port=0

quarkus.management.enabled=true
quarkus.management.port=8182
quarkus.management.test-port=0

quarkus.log.level=INFO
quarkus.log.console.enable=true
quarkus.log.console.level=ALL
quarkus.log.console.json=false
# TODO wire up MDC %X{aid}%X{sid}%X{tid}%X{wid}%X{oid}%X{srv}%X{job}%X{rid}
quarkus.log.console.format=%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{3.}] (%t) %s%e%n
quarkus.log.file.enable=true
quarkus.log.file.level=ALL
quarkus.log.file.json=false
quarkus.log.file.format=%d{yyyy-MM-dd HH:mm:ss,SSS} %h %N[%i] %-5p [%c{3.}] (%t) %s%e%n
quarkus.log.file.path=./logs/polaris.log
quarkus.log.file.rotation.file-suffix=.yyyy-MM-dd.gz
quarkus.log.file.rotation.max-file-size=10M
quarkus.log.file.rotation.max-backup-index=14
quarkus.log.category."org.apache.polaris".level=INFO
quarkus.log.category."org.apache.iceberg.rest".level=INFO

polaris.context.default-realm=default-realm
polaris.context.call-context-resolver.type=default
polaris.context.realm-context-resolver.type=default

polaris.config.feature-configurations.ENFORCE_PRINCIPAL_CREDENTIAL_ROTATION_REQUIRED_CHECKING=false
polaris.config.feature-configurations.SUPPORTED_CATALOG_STORAGE_TYPES=["S3","GCS","AZURE","FILE"]

polaris.persistence.metastore-manager.type=in-memory

polaris.io.file-io-factory.type=default

polaris.tasks.pool-size=10
polaris.tasks.fixed-size=true
polaris.tasks.thread-name-pattern=taskHandler-%d

polaris.rate-limiter.type=no-op
polaris.rate-limiter.realm-token-bucket.requests-per-second=9999
polaris.rate-limiter.realm-token-bucket.window=PT10S

polaris.authentication.type=default
polaris.authentication.oauth2-service.type=default
polaris.authentication.key-provider.type=local-rsa
polaris.authentication.token-broker-factory.type=rsa-key-pair
polaris.authentication.token-broker-factory.max-token-generation=PT1H
#polaris.authentication.token-broker-factory.symmetric-key.secret=secret
#polaris.authentication.token-broker-factory.symmetric-key.file=/tmp/symmetric.key

# FIXME these were created to make CDI happy, see PolarisStorageIntegrationProviderImpl
polaris.storage.aws.awsAccessKey=accessKey
polaris.storage.aws.awsSecretKey=secretKey
polaris.storage.gcp.token=token
polaris.storage.gcp.lifespan=PT1H

%test.quarkus.log.file.enable=false
%test.quarkus.log.category."org.apache.polaris".level=DEBUG
%test.quarkus.log.category."org.apache.iceberg.rest".level=DEBUG
%test.quarkus.otel.enabled=false
%test.quarkus.http.limits.max-body-size=1000000
%test.polaris.context.default-realm=POLARIS
%test.polaris.config.feature-configurations.ALLOW_EXTERNAL_METADATA_FILE_LOCATION=false
%test.polaris.config.feature-configurations.ALLOW_OVERLAPPING_CATALOG_URLS=true
%test.polaris.config.feature-configurations.ALLOW_SPECIFYING_FILE_IO_IMPL=true
%test.polaris.config.feature-configurations.ALLOW_WILDCARD_LOCATION=true
%test.polaris.config.feature-configurations.ENFORCE_PRINCIPAL_CREDENTIAL_ROTATION_REQUIRED_CHECKING=true
%test.polaris.config.feature-configurations.INITIALIZE_DEFAULT_CATALOG_FILEIO_FOR_TEST=true
%test.polaris.config.feature-configurations.SKIP_CREDENTIAL_SUBSCOPING_INDIRECTION=true
%test.polaris.config.feature-configurations.SUPPORTED_CATALOG_STORAGE_TYPES=["FILE","S3","GCS","AZURE"]
%test.polaris.authentication.token-broker-factory.type=symmetric-key
%test.polaris.authentication.token-broker-factory.symmetric-key.secret=polaris